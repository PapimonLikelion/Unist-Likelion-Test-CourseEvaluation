{% extends 'base.html' %}
{% load static %}

{% block css %}
<link rel="stylesheet" href="{% static 'portfolio/detail.css' %}">
{% endblock %}

{% block content %}

<div class="container d-flex justify-content-center detail ">
  <div class="d-flex bd-highlight mb-3 head">
    <div class="p-2 bd-highlight text-right">{{course.course_semester}} 학기 </div>
    <div class="p-2 bd-highlight text-right">{{course.course_code}} </div>
    <div class="p-2 bd-highlight text-right">{{course.course_name}} </div>
    <div class="p-2 bd-highlight text-right">{{course.course_professor}} 교수님 </div>
  </div>
</div>


<div class="container">
  <div class="row">
    {% for eval in evaluation %}
    <div class="card w-100 mb-5">
      <div class="card-header">
        <div class="row">
          <div class="col d-flex justify-content-start">Written at {{eval.created_at}}</div>
          <div class="col d-flex justify-content-end">
            <a herf="" type="button" class="btn btn-info mr-3 text-white" data-toggle="modal" data-target="#update">
              수정하기
            </a>
            <a class="btn btn-danger mr-3 text-white open-delete-modal" data-toggle="modal" data-target="#delete"
              data-id="{{eval.id}}" data-CSRF="{{csrf_token}}">
              삭제하기
            </a>
          </div>
        </div>
      </div>
      <div class="card-body">
        <blockquote class="blockquote mb-0">
          <p>{{eval.review}}</p>
          <footer class="blockquote-footer">10점 만점에 {{eval.grade}}점</footer>
        </blockquote>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<div id="modal-div"></div>

<!-- 수정하기 Modal -->
<!-- <div class="modal fade" id="update" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">강의평가 수정하기</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="input-group mb-3">
          <div class="input-group-prepend">
            <span class="input-group-text" id="inputGroup-sizing-default">Default</span>
          </div>
          <input type="text" class="form-control" aria-label="Sizing example input"
            aria-describedby="inputGroup-sizing-default">
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Modify</button>
      </div>
    </div>
  </div>
</div> -->

<!-- 삭제하기 Modal -->
<div class="modal fade" id="delete" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">강의평가 삭제하기{{modal_evaluation.id}}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="input-group mb-3">
          <div class="input-group-prepend">
            <span class="input-group-text" id="inputGroup-sizing-default"">Password</span>
          </div>
          <input type=" text" class="form-control" aria-label="Sizing example input"
              aria-describedby="inputGroup-sizing-default" name="password">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary delete-evaluation">Delete</button>
        </div>
      </div>
    </div>
  </div>


  <script>
    $(function () {
      var evaluation_id = 0
      var csrf_token = $(".open-delete-modal").data().CSRF;
      $(".open-delete-modal").click(function () {
        evaluation_id = $(this).data('id');
      })
      $(document).on('click', '.delete-evaluation', function () {
        console.log(evaluation_id)
        $.ajax({
          url: "/delete-course-evaluation" + "/" + evaluation_id,
          type: 'DELETE',
          headers: {
            "X-CSRFTOKEN": "{{ csrf_token }}"
          },
          error: function () {
            console.log('error')
          },
        })
      })
    });
  </script>
  {% endblock %}

  $(document).on('click', '.delete-evaluation', function () {
  document.location = "/delete-course-evaluation" + "/" + evaluation_id;
  })